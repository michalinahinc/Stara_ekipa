---
title: "Przygotowanie danych"
author: "Nikola Chrzonowska, Karolina Popiołek, Michalina Hinc"
date: "2024-12-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Wprowadzenie i cel projektu

Celem niniejszego projektu jest opracowanie i wdrożenie systemu automatycznej oceny zdolności kredytowej klientów w czasie rzeczywistym. Projekt zakłada stworzenie modelu klasyfikacyjnego, który na podstawie danych podanych przez klienta podczas wypełniania wniosku online będzie w stanie precyzyjnie określić, czy dany klient kwalifikuje się do otrzymania pożyczki.

System ten ma na celu nie tylko przyspieszenie procesu decyzyjnego, ale także zwiększenie jego trafności. Dzięki segmentacji klientów oraz identyfikacji cech charakterystycznych dla osób spełniających kryteria kredytowe, firma będzie mogła dostosować swoje oferty do konkretnych grup odbiorców.

Dane, na których pracujemy obejmują: płeć, stan cywilny,liczba osób na utrzymaniu, wykształcenie, informację czy wnioskodawca prowadzi działalność gospodarczą, jego dochód, dochód współwnioskodawcy, kwotę pożyczki, okres spłaty, historię kredytową, lokalizację nieruchomości i status przyznania pożyczki. Mają 615 wierszy i 13 kolumn.

## 2. Przygotowanie danych

### 2.1. Ładowanie potrzebnych pakietów i danych

Naszym pierwszym krokiem będizie...
```{r ładowanie pakietów}
library(tidyverse)
library(dlookr)
library(editrules)
library(validate)
library(naniar)
library(VIM)
attach(pozyczki)
```

### 2.1. Analiza braków danych

Za pomocą pakietu "naniar" sprawdzamy, czy w naszym zbiorze danych występują braki danych.

```{r}
#sprawdzamy, czy w zbiorze danych występują braki danych
n_miss(pozyczki)
#mamy 149 braków danych

#procent braków danych
prop_miss(pozyczki)
#mamy 1,9% braków danych w stosunku do całości obserwacji

#tabela podsumowująca
miss_var_summary(pozyczki)
#najwięcej braków mamy w kolumnie "credit_history", ale są też kolumny, w których jest komplet danych

#wizualizacja ogólna
vis_miss(pozyczki)
#vis_miss(pozyczki, cluster=TRUE)
vis_miss(pozyczki, sort_miss=TRUE)

#mapa
gg_miss_fct(pozyczki, fct = Self_Employed)
gg_miss_fct(pozyczki, fct = Married)
gg_miss_fct(pozyczki, fct = Education)
gg_miss_fct(pozyczki, fct = Credit_History)

#Naszym zdaniem zmienna Education prezentuje największe rozbieżności pomiędzy brakami danych.
```

#poprawianie błędów pozyczki
```{r}
localizeErrors(reguly, pozyczki$LoanAmount) <- NA
```

#poprawianie błędów:
pozyczki[localizeErrors(reguly, pozyczki$LoanAmount)] <-NA

pozyczki$LoanAmount[localizeErrors(reguly, pozyczki$LoanAmount)] <- NA

pozyczki$LoanAmount[localizeErrors(reguly, pozyczki)] <- NA


# instalujemy pakiety
library(tidyverse)
library(dlookr)
library(editrules)
library(validate)
attach(pozyczki)

#REGUŁY
reguly <- editset(c(
  "LoanAmount > 0",
  "ApplicantIncome >= 0",
  "CoapplicantIncome >= 0",
  "Education %in% c('Graduate', 'Not Graduate')",
  "Property_Area %in% c('Urban', 'Semiurban', 'Rural')"
))

# walidacja
bledy <- violatedEdits(reguly, pozyczki)

# Poprawa marginesów lub użycie nowego okna graficznego
par(mar = c(5, 4, 2, 1)) # Opcjonalnie zmniejszenie marginesów
plot(bledy)

#imputacja
library(dplyr) # ładuję biblioteki
library(ggplot2)
library(rmdformats)
library(validate)
library(validatetools)
library(dcmodify)
library(errorlocate)
library(deductive)
library(VIM)
library(simputation)
library(lumberjack)
library(ISLR) 
library(dlookr)
library(xts)
library(quantmod)
library(ROCR)
library(DMwR)
library(Information)
library(scorecard)

find_na(pozyczki)
imputate_na (pozyczki, method = "median")


#imputacja brakow danych
czyste_dane <- hotdeck(pozyczki)
